<div class="container mx-auto p-6 max-w-6xl" style="overflow-y: auto; scroll-behavior: smooth; max-height: 80vh; border: 2px solid #1E40AF; border-radius: 8px; background-color: #E0E7FF; max-width: 1800px; font-family: 'Aptos Narrow', sans-serif !important;">
  <h5 class="text-2xl font-bold text-center text-blue-900 mb-2">Application for Create, Change and Delete E-mail/User AD</h5>
  <hr class="border-blue-900 mb-4">
  <form [formGroup]="emailForm" (ngSubmit)="onSubmit()" class="bg-white p-8 rounded-xl shadow-lg max-w-full mx-auto">
    <!-- Top Section -->
    <div class="grid grid-cols-1 gap-6 mb-6">
      <div class="text-center">
        <p class="text-sm font-semibold text-gray-700">
          <span class="font-bold text-base">Noted:</span> If you have requests for "New registration," "Change," or "Deletion," please use one sheet for each.
        </p>
      </div>
    </div>

    <!-- Request Section (Card Design) -->
    <div class="mb-6 bg-white rounded-xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition-shadow">
      <label class="block text-lg font-bold text-red-900 mb-4">Request Section</label>
      <div class="grid grid-cols-1 gap-6 mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div>
            <label for="date" class="block text-sm font-semibold text-blue-900 mb-1">Current Date:</label>
            <input id="date" type="date" formControlName="date" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Section:</label>
            <select formControlName="department" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="">Select&nbsp;your&nbsp;Section</option>
              <option *ngIf="sections.length === 0" value="">Loading sections...</option>
              <option *ngFor="let section of sections" [ngValue]="section.sectid">{{ section.SectionCode }}</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Name:</label>
            <input type="text" formControlName="applicantName" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Phone:</label>
            <input type="text" formControlName="applicantPhone" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
        </div>
      </div>

      <!-- Purpose of Application -->
      <div class="mb-6">
        <label class="block text-sm font-semibold text-blue-900 mb-1">Purpose of Application</label>
        <textarea formControlName="purpose" rows="4" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
      </div>

      <!-- Table Section -->
      <div class="overflow-x-auto mb-8">
        <table class="min-w-full border-2 border-gray-400 text-sm">
          <thead>
            <tr class="bg-blue-50 text-blue-900 font-semibold">
              <th class="border-2 border-gray-400 px-4 py-2">Classification</th>
              <th class="border-2 border-gray-400 px-4 py-2">User&nbsp;Email</th>
              <th class="border-2 border-gray-400 px-4 py-2">User&nbsp;AD</th>
              <th class="border-2 border-gray-400 px-4 py-2">ID</th>
              <th class="border-2 border-gray-400 px-4 py-2">Gender</th>
              <th class="border-2 border-gray-400 px-4 py-2">First Name</th>
              <th class="border-2 border-gray-400 px-4 py-2">Family Name</th>
              <th class="border-2 border-gray-400 px-4 py-2">Position</th>
              <th class="border-2 border-gray-400 px-4 py-2">Section</th>
              <th class="border-2 border-gray-400 px-4 py-2" *ngIf="isAnyClassificationChange()">Change&nbsp;Details</th>
            </tr>
          </thead>
          <tbody formArrayName="users">
            <tr *ngFor="let user of users.controls; let i = index" [formGroupName]="i">
              <td class="border-2 border-gray-400 px-4 py-2">
                <select formControlName="classification" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  <option value="New registration">New registration</option>
                  <option value="Deletion">Deletion</option>
                  <option value="Change">Change</option>
                </select>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2 text-center">
                <input type="checkbox" formControlName="isEmail" class="h-5 w-5 text-blue-600">
              </td>
              <td class="border-2 border-gray-400 px-4 py-2 text-center">
                <input type="checkbox" formControlName="isADUser" class="h-5 w-5 text-blue-600">
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <input formControlName="id" placeholder="( Enter ID )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                <div *ngIf="user.get('id')?.invalid && user.get('id')?.touched" class="text-red-600 text-xs mt-1">
                  Please enter a valid ID.
                </div>
                <div *ngIf="user.get('id')?.value && user.get('firstName')?.value === '' && user.get('id')?.valid && user.get('classification')?.value !== 'Change'" class="text-red-600 text-xs mt-1">
                  ID not found
                </div>
                <div *ngIf="user.get('id')?.value && user.get('firstNameBeforeChange')?.value === '' && user.get('id')?.valid && user.get('classification')?.value === 'Change'" class="text-red-600 text-xs mt-1">
                  ID not found
                </div>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <select formControlName="sex" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  <option value="">Select Gender</option>
                  <option value="M">Male</option>
                  <option value="F">Female</option>
                </select>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <div class="flex flex-col gap-2" *ngIf="user.get('classification')?.value === 'Change'; else firstNameInput">
                  <div>
                    <input formControlName="firstNameBeforeChange" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <input formControlName="firstNameAfterChange" placeholder="After Change" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  </div>
                </div>
                <ng-template #firstNameInput>
                  <input formControlName="firstName" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <div class="flex flex-col gap-2" *ngIf="user.get('classification')?.value === 'Change'; else familyNameInput">
                  <div>
                    <input formControlName="familyNameBeforeChange" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <input formControlName="familyNameAfterChange" placeholder="After Change" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                  </div>
                </div>
                <ng-template #familyNameInput>
                  <input formControlName="familyName" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <div class="flex flex-col gap-2" *ngIf="user.get('classification')?.value === 'Change'; else positionInput">
                  <div>
                    <input formControlName="positionBeforeChange" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm bg-gray-100" readonly>
                  </div>
                  <div>
                    <input formControlName="positionAfterChange" placeholder="( New Position )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm bg-gray-100">
                  </div>
                </div>
                <ng-template #positionInput>
                  <input formControlName="position" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm bg-gray-100" readonly>
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <div class="flex flex-col gap-2" *ngIf="user.get('classification')?.value === 'Change'; else sectionInput">
                  <div>
                    <input formControlName="sectionBeforeChange" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm bg-gray-100" readonly>
                  </div>
                  <div>
                    <select formControlName="sectionAfterChange" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      <option value="">New Sections</option>
                      <option *ngFor="let section of sections" [value]="section.SectionCode">{{ section.SectionCode }}</option>
                    </select>
                  </div>
                </div>
                <ng-template #sectionInput>
                  <input formControlName="section" placeholder="( Auto-filled )" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm bg-gray-100" readonly>
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2" *ngIf="user.get('classification')?.value === 'Change'">
                <div class="flex flex-col gap-2">
                  <div>
                    <label class="block text-xs font-semibold text-blue-900 mb-1">Before&nbsp;Change</label>
                  </div>
                  <div>
                    <label class="block text-xs font-semibold text-blue-900 mb-1">After&nbsp;Change</label>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="flex gap-4 mt-4">
          <button type="button" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors" (click)="addUserRow()">Add Row</button>
          <button type="button" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors" (click)="deleteUserRow()">Delete Row</button>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-semibold text-blue-900 mb-1">Prepared by</label>
          <input formControlName="preparedBy" type="text" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div class="relative">
          <label class="block text-sm font-semibold text-blue-900 mb-1">Checked by</label>
          <div class="flex items-center gap-2">
            <input formControlName="checkedBy" type="text" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <button type="button" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors" (click)="openReferModal()">Refer</button>
          </div>
        </div>
      </div>
    </div>

    <!-- IT Section (Card Design) -->
    <div class="mb-6 bg-white rounded-xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition-shadow">
      <label class="block text-lg font-bold text-red-900 mb-4">IT Section</label>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <div>
          <label class="block text-sm font-semibold text-blue-900 mb-1">Prepared by</label>
          <p class="text-sm">{{ emailForm.get('ITpreparedBy')?.value }}</p>
        </div>
        <div>
          <label class="block text-sm font-semibold text-blue-900 mb-1">Checked by</label>
          <p class="text-sm">{{ emailForm.get('ITcheckedBy')?.value }}</p>
        </div>
        <div>
          <label class="block text-sm font-semibold text-blue-900 mb-1">Verified by</label>
          <p class="text-sm">{{ emailForm.get('ITverifiedBy')?.value }}</p>
        </div>
        <div>
          <label class="block text-sm font-semibold text-blue-900 mb-1">Approved by</label>
          <p class="text-sm">{{ emailForm.get('ITapprovedBy')?.value }}</p>
        </div>
      </div>
    </div>

    <div class="text-center" style="padding-bottom: 25px;">
      <button type="button" (click)="saveDocument()" class="bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-900 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed">Save&nbsp;Document</button>
    </div>

    <!-- Preview Card -->
    <div *ngIf="isPreviewVisible" class="mb-6 bg-white rounded-xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition-shadow">
      <label class="block text-lg font-bold text-red-900 mb-4 text-center" style="font-size: 30px; padding-bottom: 18px;">Preview Your Request Application Form</label>
      <div class="mb-6">
        <label class="block text-lg font-bold text-red-900 mb-4">Request&nbsp;Section</label>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Current Date:</label>
            <p class="text-sm">{{ emailForm.get('date')?.value | date:'mediumDate' }}</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Department:</label>
            <p class="text-sm">{{ getSectionCode(emailForm.get('department')?.value) }}</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Name:</label>
            <p class="text-sm">{{ emailForm.get('applicantName')?.value }}</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Phone:</label>
            <p class="text-sm">{{ emailForm.get('applicantPhone')?.value }}</p>
          </div>
        </div>
      </div>
      <div class="mb-6">
        <label class="block text-sm font-semibold text-blue-900 mb-1">Purpose of Application</label>
        <p class="text-sm">{{ emailForm.get('purpose')?.value }}</p>
      </div>

      <!-- Preview Table -->
      <div class="overflow-x-auto mb-8">
        <table class="min-w-full border-2 border-gray-400 text-sm">
          <thead>
            <tr class="bg-blue-50 text-blue-900 font-semibold">
              <th class="border-2 border-gray-400 px-4 py-2">Classification</th>
              <th class="border-2 border-gray-400 px-4 py-2">User&nbsp;Email</th>
              <th class="border-2 border-gray-400 px-4 py-2">User&nbsp;AD</th>
              <th class="border-2 border-gray-400 px-4 py-2">ID</th>
              <th class="border-2 border-gray-400 px-4 py-2">Gender</th>
              <th class="border-2 border-gray-400 px-4 py-2">First Name</th>
              <th class="border-2 border-gray-400 px-4 py-2">Family Name</th>
              <th class="border-2 border-gray-400 px-4 py-2">Position</th>
              <th class="border-2 border-gray-400 px-4 py-2">Section</th>
              <th class="border-2 border-gray-400 px-4 py-2" *ngIf="isAnyClassificationChange()">Change&nbsp;Details</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of users.controls; let i = index" [formGroupName]="i">
              <td class="border-2 border-gray-400 px-4 py-2">{{ user.get('classification')?.value }}</td>
              <td class="border-2 border-gray-400 px-4 py-2 text-center">
                {{ user.get('isEmail')?.value ? '✓' : '✗' }}
              </td>
              <td class="border-2 border-gray-400 px-4 py-2 text-center">
                {{ user.get('isADUser')?.value ? '✓' : '✗' }}
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <ng-container *ngIf="user.get('classification')?.value === 'Change'; else idDisplay">
                  <div class="flex flex-col gap-2">
                    <div>{{ user.get('id')?.value }}</div>
                  </div>
                </ng-container>
                <ng-template #idDisplay>
                  {{ user.get('id')?.value }}
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                {{ user.get('sex')?.value || 'Not selected' }}
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <ng-container *ngIf="user.get('classification')?.value === 'Change'; else firstNameDisplay">
                  <div class="flex flex-col gap-2">
                    <div>{{ user.get('firstNameBeforeChange')?.value }}</div>
                    <div>{{ user.get('firstNameAfterChange')?.value }}</div>
                  </div>
                </ng-container>
                <ng-template #firstNameDisplay>
                  {{ user.get('firstName')?.value }}
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <ng-container *ngIf="user.get('classification')?.value === 'Change'; else familyNameDisplay">
                  <div class="flex flex-col gap-2">
                    <div>{{ user.get('familyNameBeforeChange')?.value }}</div>
                    <div>{{ user.get('familyNameAfterChange')?.value }}</div>
                  </div>
                </ng-container>
                <ng-template #familyNameDisplay>
                  {{ user.get('familyName')?.value }}
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <ng-container *ngIf="user.get('classification')?.value === 'Change'; else positionDisplay">
                  <div class="flex flex-col gap-2">
                    <div>{{ user.get('positionBeforeChange')?.value }}</div>
                    <div>{{ user.get('positionAfterChange')?.value }}</div>
                  </div>
                </ng-container>
                <ng-template #positionDisplay>
                  {{ user.get('position')?.value }}
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2">
                <ng-container *ngIf="user.get('classification')?.value === 'Change'; else sectionDisplay">
                  <div class="flex flex-col gap-2">
                    <div>{{ user.get('sectionBeforeChange')?.value }}</div>
                    <div>{{ user.get('sectionAfterChange')?.value }}</div>
                  </div>
                </ng-container>
                <ng-template #sectionDisplay>
                  {{ user.get('section')?.value }}
                </ng-template>
              </td>
              <td class="border-2 border-gray-400 px-4 py-2" *ngIf="user.get('classification')?.value === 'Change'">
                <div class="flex flex-col gap-2">
                  <div>
                    <label class="block text-xs font-semibold text-blue-900 mb-1">Before&nbsp;Change</label>
                  </div>
                  <div>
                    <label class="block text-xs font-semibold text-blue-900 mb-1">After&nbsp;Change</label>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Display Prepared By and Checked By -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <div>
          <label class="block text-sm font-semibold text-blue-900 mb-1">Prepared by</label>
          <p class="text-sm">{{ emailForm.get('preparedBy')?.value }}</p>
        </div>
        <div>
          <label class="block text-sm font-semibold text-blue-900 mb-1">Checked by</label>
          <p class="text-sm">{{ emailForm.get('checkedBy')?.value }}</p>
        </div>
      </div>

      <!-- Display IT Section -->
      <div class="mb-6">
        <label class="block text-lg font-bold text-red-900 mb-4">IT Section</label>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Prepared by</label>
            <p class="text-sm">{{ emailForm.get('ITpreparedBy')?.value }}</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Checked by</label>
            <p class="text-sm">{{ emailForm.get('ITcheckedBy')?.value }}</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Verified by</label>
            <p class="text-sm">{{ emailForm.get('ITverifiedBy')?.value }}</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-blue-900 mb-1">Approved by</label>
            <p class="text-sm">{{ emailForm.get('ITapprovedBy')?.value }}</p>
          </div>
        </div>
      </div>

      <!-- Buttons -->
      <div class="flex gap-4 mt-4 justify-center">
        <button type="button" (click)="backToEdit()" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed">Back To Edit</button>
        <button type="submit" class="bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-900 transition-colors disabled:bg-gray-400">Submit Form</button>
      </div>
    </div>

    <!-- Refer Modal -->
    <div *ngIf="isReferModalOpen" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-xl shadow-lg p-6 max-w-2xl w-full">
        <h2 class="text-lg font-bold text-blue-800 mb-4">Refer</h2>
        <form [formGroup]="referForm" class="mb-4">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
              <label class="block text-sm font-semibold text-blue-900 mb-1">Employee Code</label>
              <input formControlName="searchId" type="text" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div>
              <label class="block text-sm font-semibold text-blue-900 mb-1">Name</label>
              <input formControlName="searchName" type="text" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div>
              <label class="block text-sm font-semibold text-blue-900 mb-1">Section</label>
              <select formControlName="searchSection" class="w-full border-2 border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                <option value="">All Sections</option>
                <option *ngFor="let section of sections" [value]="section.SectionCode">{{ section.SectionCode }}</option>
              </select>
            </div>
          </div>
          <div class="flex gap-4 mt-4">
            <button type="button" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors" (click)="searchPeople()">Search</button>
            <button type="button" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition-colors" (click)="resetSearch()">Reset</button>
          </div>
        </form>
        <div *ngIf="isLoadingEmployees" class="text-center text-gray-600">Loading employees...</div>
        <div *ngIf="employeeLoadError" class="text-center text-red-600">Error: {{ employeeLoadError }}</div>
        <div *ngIf="hasSearched && !isLoadingEmployees && !employeeLoadError" class="overflow-x-auto max-h-[400px] overflow-y-auto">
          <div class="mb-2 text-gray-600">Found {{ filteredPeople.length }} employees</div>
          <dx-data-grid
            [dataSource]="filteredPeople"
            [hoverStateEnabled]="true"
            [rowAlternationEnabled]="true"
            [showBorders]="true"
            (onRowClick)="selectPerson($event.data)"
            [columnAutoWidth]="true"
            [wordWrapEnabled]="true"
            [allowColumnResizing]="true"
            [height]="400"
            noDataText="No results found">
            <dxi-column dataField="employeeCode" caption="Employee Code" [width]="120" sortOrder="asc"></dxi-column>
            <dxi-column dataField="englishName" caption="Name" [width]="150"></dxi-column>
            <dxi-column dataField="sectionName" caption="Section" [width]="100"></dxi-column>
            <dxi-column dataField="email" caption="Email" [width]="260"></dxi-column>
            <dxo-paging [enabled]="false"></dxo-paging>
            <dxo-scrolling
              mode="standard"
              [useNative]="false"
              [scrollByContent]="true"
              [scrollByThumb]="true"
              showScrollbar="onHover">
            </dxo-scrolling>
          </dx-data-grid>
        </div>
        <div class="text-right mt-4">
          <button type="button" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors" (click)="closeReferModal()">Close</button>
        </div>
      </div>
    </div>

    <!-- Submission Feedback -->
    <div *ngIf="submissionStatus" class="mt-4 p-4 rounded-lg" [ngClass]="{'bg-green-100': submissionStatus === 'success', 'bg-red-100': submissionStatus === 'error'}">
      <p class="text-sm font-semibold">{{ submissionMessage }}</p>
      <p class="text-sm">{{ submissionDetails }}</p>
    </div>
  </form>
</div>